# vaschooldata

**[Documentation](https://almartin82.github.io/vaschooldata/)** \|
[GitHub](https://github.com/almartin82/vaschooldata)

Fetch and analyze Virginia school enrollment data from the Virginia
Department of Education (VDOE) in R or Python. Data for every school and
division in Virginia.

## Part of the State Schooldata Project

This package is part of a collection of state education data packages
inspired by [njschooldata](https://github.com/almartin82/njschooldata),
the original R package for accessing New Jersey school data. The goal is
to provide a simple, consistent interface for accessing state-published
school data across all 50 states.

**All state packages:**
[github.com/almartin82](https://github.com/almartin82?tab=repositories&q=schooldata)

## What can you find with vaschooldata?

Virginia educates **1.25 million students** across 132 school divisions,
from the coalfields of Appalachia to the suburbs of Northern Virginia.
Here are fifteen stories hiding in the data:

------------------------------------------------------------------------

### 1. The Northern Virginia Boom

While most of Virginia holds steady, **Loudoun County** has exploded.
From 52,000 students in 2016 to over 82,000 today, it is now Virginia’s
4th-largest division.

``` r
library(vaschooldata)
library(dplyr)

# Loudoun's explosive growth
fetch_enr_multi(2016:2023, use_cache = TRUE) |>
  filter(is_district, grepl("Loudoun", district_name),
         subgroup == "total_enrollment", grade_level == "TOTAL") |>
  select(end_year, district_name, n_students)
```

![Loudoun County enrollment
growth](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks_files/figure-html/loudoun-chart-1.png)

Loudoun County enrollment growth

------------------------------------------------------------------------

### 2. The Fairfax Giant

**Fairfax County Public Schools** alone enrolls more students than 42
states’ entire charter sectors. At 180,000 students, it is the
10th-largest district in America.

``` r
fetch_enr(2023, use_cache = TRUE) |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL") |>
  arrange(desc(n_students)) |>
  select(district_name, n_students) |>
  head(5)
```

![Virginia’s largest
divisions](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks_files/figure-html/top-districts-chart-1.png)

Virginia’s largest divisions

------------------------------------------------------------------------

### 3. The Rural Decline

While Northern Virginia grows, **Southwest Virginia is vanishing**. Lee
County has lost 45% of its students since 2016. Dickenson County: down
40%+.

``` r
fetch_enr_multi(c(2016, 2023), use_cache = TRUE) |>
  filter(is_district, grepl("Lee County|Dickenson", district_name),
         subgroup == "total_enrollment", grade_level == "TOTAL") |>
  select(end_year, district_name, n_students) |>
  tidyr::pivot_wider(names_from = end_year, values_from = n_students)
```

![Rural decline
chart](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks_files/figure-html/rural-decline-chart-1.png)

Rural decline chart

------------------------------------------------------------------------

### 4. Virginia’s Demographic Transformation

Virginia is becoming increasingly diverse. Hispanic students are the
fastest-growing demographic group.

``` r
fetch_enr_multi(c(2016, 2023), use_cache = TRUE) |>
  filter(is_state, grade_level == "TOTAL",
         subgroup %in% c("white", "black", "hispanic", "asian")) |>
  select(end_year, subgroup, n_students, pct)
```

![Demographics
chart](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks_files/figure-html/demographics-chart-1.png)

Demographics chart

------------------------------------------------------------------------

### 5. The COVID Dip

Virginia lost students between 2019 and 2021. Enrollment has partially
recovered but remains below pre-pandemic levels.

``` r
fetch_enr_multi(2019:2024, use_cache = TRUE) |>
  filter(is_state, subgroup == "total_enrollment", grade_level == "TOTAL") |>
  select(end_year, n_students)
```

![COVID enrollment
impact](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks_files/figure-html/covid-chart-1.png)

COVID enrollment impact

------------------------------------------------------------------------

### 6. The Charter Desert

Unlike many states, Virginia has **fewer than 10 charter schools**
statewide. The legislature has historically been restrictive.

``` r
charter_data <- fetch_enr(2023, use_cache = TRUE) |>
  filter(grepl("charter", tolower(campus_name)) | grepl("charter", tolower(district_name)),
         subgroup == "total_enrollment", grade_level == "TOTAL")

if (nrow(charter_data) > 0) {
  charter_data |>
    summarize(n_charter_schools = n(), total_students = sum(n_students, na.rm = TRUE))
} else {
  data.frame(n_charter_schools = 0, total_students = 0)
}
```

    #>   n_charter_schools total_students
    #> 1                 0              0

------------------------------------------------------------------------

### 7. The Hampton Roads Plateau

Virginia Beach, Norfolk, and Newport News, once growing military hubs,
have **flatlined for two decades**.

``` r
fetch_enr_multi(c(2016, 2024), use_cache = TRUE) |>
  filter(is_district, grepl("Virginia Beach|Norfolk|Newport News", district_name),
         subgroup == "total_enrollment", grade_level == "TOTAL") |>
  select(end_year, district_name, n_students)
```

![Hampton Roads
trends](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks_files/figure-html/hampton-roads-chart-1.png)

Hampton Roads trends

------------------------------------------------------------------------

### 8. Kindergarten as Crystal Ball

Kindergarten enrollment predicts the future. **Richmond City**
kindergarten has dropped, signaling continued enrollment pressure.

``` r
fetch_enr_multi(2019:2023, use_cache = TRUE) |>
  filter(is_district, grepl("Richmond City", district_name),
         subgroup == "total_enrollment", grade_level == "K") |>
  select(end_year, n_students)
```

![Kindergarten
trends](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks_files/figure-html/kindergarten-chart-1.png)

Kindergarten trends

------------------------------------------------------------------------

### 9. The Wealthiest Division in Virginia

**Falls Church City**, a tiny independent city in Northern Virginia, is
100% in Fairfax County but operates its own schools. Median income:
\$150,000+.

``` r
fetch_enr(2023, use_cache = TRUE) |>
  filter(is_district, grepl("Falls Church", district_name),
         subgroup == "total_enrollment", grade_level == "TOTAL") |>
  select(district_name, n_students)
```

    #> # A tibble: 1 x 2
    #>   district_name                    n_students
    #>   <chr>                                 <dbl>
    #> 1 FALLS CHURCH CITY PUBLIC SCHOOLS       2496

------------------------------------------------------------------------

### 10. 9 Years of VDOE Data

This package provides **9 years** of Virginia enrollment data from the
VDOE School Quality Profiles (2016-2024).

``` r
# Years available
get_available_years()
```

    #> [1] 2016 2017 2018 2019 2020 2021 2022 2023 2024

``` r
# Count divisions over time
fetch_enr_multi(c(2016, 2020, 2024), use_cache = TRUE) |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL") |>
  group_by(end_year) |>
  summarize(n_divisions = n(), total_students = sum(n_students, na.rm = TRUE))
```

    #> # A tibble: 3 x 3
    #>   end_year n_divisions total_students
    #>      <int>       <int>          <dbl>
    #> 1     2016         132        1271801
    #> 2     2020         132        1249026
    #> 3     2024         132        1261962

------------------------------------------------------------------------

### 11. Richmond City’s Enrollment Pressure

**Richmond City Public Schools** has lost students steadily, with
enrollment dropping from 24,000 to under 22,000 since 2016.

``` r
fetch_enr_multi(2016:2024, use_cache = TRUE) |>
  filter(is_district, grepl("Richmond City", district_name),
         subgroup == "total_enrollment", grade_level == "TOTAL") |>
  select(end_year, n_students)
```

![Richmond City enrollment
trends](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks_files/figure-html/richmond-chart-1.png)

Richmond City enrollment trends

------------------------------------------------------------------------

### 12. Hampton Roads Military Corridor

Virginia Beach, Norfolk, Newport News, and Hampton together educate
**180,000+ students**, but enrollment has plateaued despite the large
military presence.

``` r
fetch_enr_multi(c(2016, 2024), use_cache = TRUE) |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL",
         grepl("Virginia Beach|Norfolk|Newport News|Hampton", district_name)) |>
  group_by(end_year) |>
  summarize(total = sum(n_students, na.rm = TRUE))
```

------------------------------------------------------------------------

### 13. Elementary vs. High School Shifts

COVID’s kindergarten dip is now visible in elementary grades, while high
school enrollment remains stable from pre-pandemic cohorts.

``` r
fetch_enr(2024, use_cache = TRUE) |>
  filter(is_state, subgroup == "total_enrollment",
         grade_level %in% c("K", "01", "09", "12")) |>
  select(grade_level, n_students)
```

![Grade band enrollment
trends](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks_files/figure-html/grade-distribution-chart-1.png)

Grade band enrollment trends

------------------------------------------------------------------------

### 14. Southwest Virginia Coalfield Decline

The **coalfield counties** (Buchanan, Dickenson, Wise, Lee, Tazewell)
have lost 20%+ of students since 2016 as the coal economy continues to
decline.

``` r
fetch_enr_multi(c(2016, 2024), use_cache = TRUE) |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL",
         grepl("Buchanan|Dickenson|Wise|Lee|Tazewell", district_name)) |>
  group_by(end_year) |>
  summarize(total = sum(n_students, na.rm = TRUE))
```

![Coalfield enrollment
decline](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks_files/figure-html/coalfield-chart-1.png)

Coalfield enrollment decline

------------------------------------------------------------------------

### 15. The Two Virginias

Northern Virginia (Fairfax, Loudoun, Prince William, Arlington) has
**grown** since 2016 while Southwest Virginia has **declined**. These
diverging trajectories represent two different futures.

``` r
# Northern Virginia
nova <- enr |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL",
         grepl("Fairfax|Loudoun|Prince William|Arlington", district_name, ignore.case = TRUE)) |>
  group_by(end_year) |>
  summarize(nova_total = sum(n_students, na.rm = TRUE), .groups = "drop")

# Southwest Virginia
swva <- enr |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL",
         grepl("Buchanan|Dickenson|Wise|Lee County|Tazewell|Russell|Scott|Smyth|Washington", district_name, ignore.case = TRUE)) |>
  group_by(end_year) |>
  summarize(swva_total = sum(n_students, na.rm = TRUE), .groups = "drop")

# Combine and calculate indexed values (2016 = 100)
comparison <- nova |>
  left_join(swva, by = "end_year") |>
  mutate(
    nova_idx = round(nova_total / nova_total[end_year == min(end_year)] * 100, 1),
    swva_idx = round(swva_total / swva_total[end_year == min(end_year)] * 100, 1)
  )

comparison |> select(end_year, nova_idx, swva_idx)
```

    #> # A tibble: 9 x 3
    #>   end_year nova_idx swva_idx
    #>      <int>    <dbl>    <dbl>
    #> 1     2016    100      100
    #> 2     2017    101.     98.1
    #> 3     2018    102.     96.4
    #> 4     2019    103.     94.2
    #> 5     2020    102.     91.8
    #> 6     2021    101.     89.7
    #> 7     2022    102.     87.9
    #> 8     2023    101.     86.3
    #> 9     2024    101.     84.8

![Two Virginias diverging
trajectories](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks_files/figure-html/two-virginias-chart-1.png)

Two Virginias diverging trajectories

------------------------------------------------------------------------

## Installation

``` r
# install.packages("devtools")
devtools::install_github("almartin82/vaschooldata")
```

## R Quick Start

``` r
library(vaschooldata)
library(dplyr)

# Get 2023 enrollment data (2022-23 school year)
enr <- fetch_enr(2023, use_cache = TRUE)

# Statewide total
enr |>
  filter(is_state, subgroup == "total_enrollment", grade_level == "TOTAL") |>
  pull(n_students)

# Top 5 divisions
enr |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL") |>
  arrange(desc(n_students)) |>
  select(district_name, n_students) |>
  head(5)
```

## Python Quick Start

``` python
import pyvaschooldata as va

# Fetch 2023 data (2022-23 school year)
enr = va.fetch_enr(2023)

# Statewide total
total = enr[(enr['is_state'] == True) & (enr['subgroup'] == 'total_enrollment') & (enr['grade_level'] == 'TOTAL')]['n_students'].sum()
print(f"{total:,} students")

# Get multiple years
enr_multi = va.fetch_enr_multi([2020, 2021, 2022, 2023])

# Check available years
years = va.get_available_years()
print(f"Data available: {min(years)}-{max(years)}")
```

## Graduation Rate Data

``` r
library(vaschooldata)
library(dplyr)

# Get 2023 graduation rates (2022-23 school year)
grad <- fetch_graduation(2023)

# Statewide graduation rate
grad |>
  filter(is_state, diploma_type == "all") |>
  select(graduation_rate, cohort_size)

# Compare schools
grad |>
  filter(is_school, diploma_type == "all") |>
  arrange(desc(graduation_rate)) |>
  select(school_name, graduation_rate, cohort_size) |>
  head(5)
```

**Years available:** 2019-2023 (5 years) **Data source:** VDOE Cohort
Graduation and Dropout Report **Rate types:** 4-year, 5-year graduation
rates **Diploma types:** Advanced Studies, Standard, IB, GED,
Certificate, Applied Studies

## Data Format

[`fetch_enr()`](https://almartin82.github.io/vaschooldata/reference/fetch_enr.md)
returns tidy (long) format by default:

| Column                         | Description                              |
|--------------------------------|------------------------------------------|
| `end_year`                     | School year end (e.g., 2023 for 2022-23) |
| `district_id`                  | LEA ID (7 characters)                    |
| `campus_id`                    | School ID (12 characters)                |
| `type`                         | “State”, “District”, or “Campus”         |
| `district_name`, `campus_name` | Names                                    |
| `county`                       | County name                              |
| `grade_level`                  | “TOTAL”, “PK”, “K”, “01”…“12”            |
| `subgroup`                     | Demographic group                        |
| `n_students`                   | Enrollment count                         |
| `pct`                          | Percentage of total                      |

## Data Notes

**Data source:** Virginia Department of Education (VDOE) School Quality
Profiles

**Available years:** 2016-2024 (9 years)

**Entities:** State, 132 school divisions, ~2,100 schools

**Subgroups:** Total enrollment, race/ethnicity (white, black, Hispanic,
Asian, multiracial, Native American, Pacific Islander), gender,
economically disadvantaged, students with disabilities, English learners

**Suppression:** Small counts may be suppressed for student privacy

**Census Day:** Fall membership count (typically late September/early
October)

## Enrollment Visualizations

![Virginia statewide enrollment
trends](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks_files/figure-html/loudoun-chart-1.png)

![Top Virginia
districts](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks_files/figure-html/top-districts-chart-1.png)

See the [full
vignette](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks.html)
for all 15 insights with interactive charts.

## Author

Andy Martin (<almartin@gmail.com>)
[github.com/almartin82](https://github.com/almartin82)

## License

MIT

# Package index

## Main Functions

Core functions for fetching and processing enrollment data

- [`fetch_enr()`](https://almartin82.github.io/vaschooldata/reference/fetch_enr.md)
  : Fetch Virginia enrollment data
- [`fetch_enr_multi()`](https://almartin82.github.io/vaschooldata/reference/fetch_enr_multi.md)
  : Fetch enrollment data for multiple years
- [`fetch_enr_local()`](https://almartin82.github.io/vaschooldata/reference/fetch_enr_local.md)
  : Fetch enrollment using local file
- [`get_available_years()`](https://almartin82.github.io/vaschooldata/reference/get_available_years.md)
  : Get available years of Virginia enrollment data

## Graduation Rate Functions

Functions for fetching and processing graduation rate data

- [`fetch_graduation()`](https://almartin82.github.io/vaschooldata/reference/fetch_graduation.md)
  : Fetch Virginia graduation rate data
- [`fetch_graduation_multi()`](https://almartin82.github.io/vaschooldata/reference/fetch_graduation_multi.md)
  : Fetch graduation rate data for multiple years
- [`get_available_grad_years()`](https://almartin82.github.io/vaschooldata/reference/get_available_grad_years.md)
  : Get available years of graduation data

## Data Transformation

Functions for transforming and aggregating data

- [`tidy_enr()`](https://almartin82.github.io/vaschooldata/reference/tidy_enr.md)
  : Tidy enrollment data
- [`id_enr_aggs()`](https://almartin82.github.io/vaschooldata/reference/id_enr_aggs.md)
  : Identify enrollment aggregation levels
- [`enr_grade_aggs()`](https://almartin82.github.io/vaschooldata/reference/enr_grade_aggs.md)
  : Custom Enrollment Grade Level Aggregates

## Local Import

Functions for importing local data files

- [`import_local_fm()`](https://almartin82.github.io/vaschooldata/reference/import_local_fm.md)
  : Import local Fall Membership file

## Cache Management

Functions for managing locally cached data

- [`cache_status()`](https://almartin82.github.io/vaschooldata/reference/cache_status.md)
  : Show cache status
- [`clear_cache()`](https://almartin82.github.io/vaschooldata/reference/clear_cache.md)
  : Clear the vaschooldata cache
- [`clear_directory_cache()`](https://almartin82.github.io/vaschooldata/reference/clear_directory_cache.md)
  : Clear directory cache

## Directory Data

Functions for fetching and processing school directory data

- [`fetch_directory()`](https://almartin82.github.io/vaschooldata/reference/fetch_directory.md)
  : Fetch Virginia school directory data

## Package

- [`vaschooldata-package`](https://almartin82.github.io/vaschooldata/reference/vaschooldata-package.md)
  [`vaschooldata`](https://almartin82.github.io/vaschooldata/reference/vaschooldata-package.md)
  : vaschooldata: Fetch and Process Virginia School Data

# Articles

### Getting Started

- [15 Insights from Virginia School Enrollment
  Data](https://almartin82.github.io/vaschooldata/articles/enrollment_hooks.md):

### Internal
